webpackJsonp([3],{Z40Z:function(n,l,t){"use strict";Object.defineProperty(l,"__esModule",{value:!0});var u=t("LMZF"),e=function(){},s=t("UHIZ"),a=t("Un6q"),i=function(){function n(){this.active=1}return n.prototype.ngOnInit=function(){},n.prototype.makeActive=function(n){this.active=n},n}(),r=u._2({encapsulation:0,styles:[[".btn.btn-light[_ngcontent-%COMP%]{font-size:1.1487em;font-family:Lato,sans-serif}.btn.btn-light.active[_ngcontent-%COMP%]{border-bottom:3px solid #ffc107}"]],data:{}});function o(n){return u._27(0,[(n()(),u._4(0,0,null,null,17,"nav",[["class","nav nav-pills p-2 mb-2 bg-light text-dark"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n  "])),(n()(),u._4(2,0,null,null,2,"a",[["class","ml-2 btn btn-light btn-sm"],["routerLink","/dashboard/sms/send-sms"]],[[2,"active",null],[1,"target",0],[8,"href",4]],[[null,"click"]],function(n,l,t){var e=!0,s=n.component;return"click"===l&&(e=!1!==u._16(n,3).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&e),"click"===l&&(e=!1!==s.makeActive(1)&&e),e},null,null)),u._3(3,671744,null,0,s.m,[s.k,s.a,a.i],{routerLink:[0,"routerLink"]},null),(n()(),u._25(-1,null,["SEND SMS"])),(n()(),u._25(-1,null,["\n  "])),(n()(),u._4(6,0,null,null,2,"a",[["class","btn btn-light btn-sm"],["routerLink","/dashboard/sms/manual-sms"]],[[2,"active",null],[1,"target",0],[8,"href",4]],[[null,"click"]],function(n,l,t){var e=!0,s=n.component;return"click"===l&&(e=!1!==u._16(n,7).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&e),"click"===l&&(e=!1!==s.makeActive(2)&&e),e},null,null)),u._3(7,671744,null,0,s.m,[s.k,s.a,a.i],{routerLink:[0,"routerLink"]},null),(n()(),u._25(-1,null,["MANUAL SMS"])),(n()(),u._25(-1,null,["\n  "])),(n()(),u._4(10,0,null,null,2,"a",[["class","btn btn-light btn-sm"],["routerLink","/dashboard/sms/sms-history"]],[[2,"active",null],[1,"target",0],[8,"href",4]],[[null,"click"]],function(n,l,t){var e=!0,s=n.component;return"click"===l&&(e=!1!==u._16(n,11).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&e),"click"===l&&(e=!1!==s.makeActive(3)&&e),e},null,null)),u._3(11,671744,null,0,s.m,[s.k,s.a,a.i],{routerLink:[0,"routerLink"]},null),(n()(),u._25(-1,null,["HISTORY"])),(n()(),u._25(-1,null,["\n  "])),(n()(),u._4(14,0,null,null,2,"a",[["class","ml-2 btn btn-light btn-sm"],["routerLink","/dashboard/sms/sms-settings"]],[[2,"active",null],[1,"target",0],[8,"href",4]],[[null,"click"]],function(n,l,t){var e=!0,s=n.component;return"click"===l&&(e=!1!==u._16(n,15).onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)&&e),"click"===l&&(e=!1!==s.makeActive(4)&&e),e},null,null)),u._3(15,671744,null,0,s.m,[s.k,s.a,a.i],{routerLink:[0,"routerLink"]},null),(n()(),u._25(-1,null,["SMS SETTINGS"])),(n()(),u._25(-1,null,["\n"]))],function(n,l){n(l,3,0,"/dashboard/sms/send-sms"),n(l,7,0,"/dashboard/sms/manual-sms"),n(l,11,0,"/dashboard/sms/sms-history"),n(l,15,0,"/dashboard/sms/sms-settings")},function(n,l){var t=l.component;n(l,2,0,1==t.active,u._16(l,3).target,u._16(l,3).href),n(l,6,0,2==t.active,u._16(l,7).target,u._16(l,7).href),n(l,10,0,3==t.active,u._16(l,11).target,u._16(l,11).href),n(l,14,0,4==t.active,u._16(l,15).target,u._16(l,15).href)})}var c=function(){},_=u._2({encapsulation:0,styles:[".container[_ngcontent-%COMP%]{min-height: calc(100vh - 65px);}"],data:{}});function h(n){return u._27(0,[(n()(),u._25(-1,null,["\n    "])),(n()(),u._4(1,0,null,null,7,"div",[["class","container bg-white raised"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n      "])),(n()(),u._4(3,0,null,null,1,"sms-sub-navbar",[],null,null,null,o,r)),u._3(4,114688,null,0,i,[],null,null),(n()(),u._25(-1,null,["\n      "])),(n()(),u._4(6,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),u._3(7,212992,null,0,s.o,[s.b,u.N,u.j,[8,null],u.h],null,null),(n()(),u._25(-1,null,["\n    "])),(n()(),u._25(-1,null,["\n  "]))],function(n,l){n(l,4,0),n(l,7,0)},null)}var p=u._0("app-sms",c,function(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"app-sms",[],null,null,null,h,_)),u._3(1,49152,null,0,c,[],null,null)],null,null)},{},{},[]),f=t("m0ph"),m=this&&this.__awaiter||function(n,l,t,u){return new(t||(t=Promise))(function(e,s){function a(n){try{r(u.next(n))}catch(n){s(n)}}function i(n){try{r(u.throw(n))}catch(n){s(n)}}function r(n){n.done?e(n.value):new t(function(l){l(n.value)}).then(a,i)}r((u=u.apply(n,l||[])).next())})},d=this&&this.__generator||function(n,l){var t,u,e,s,a={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,u&&(e=u[2&s[0]?"return":s[0]?"throw":"next"])&&!(e=e.call(u,s[1])).done)return e;switch(u=0,e&&(s=[0,e.value]),s[0]){case 0:case 1:e=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,u=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(e=(e=a.trys).length>0&&e[e.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!e||s[1]>e[0]&&s[1]<e[3])){a.label=s[1];break}if(6===s[0]&&a.label<e[1]){a.label=e[1],e=s;break}if(e&&a.label<e[2]){a.label=e[2],a.ops.push(s);break}e[2]&&a.ops.pop(),a.trys.pop();continue}s=l.call(n,a)}catch(n){s=[6,n],u=0}finally{t=e=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},b=function(){function n(n){this.smsService=n,this.smsHistory=[],this.companyId=localStorage.getItem("companyId"),this.userId=localStorage.getItem("userId"),this.limit=5}return n.prototype.ngOnInit=function(){this.paginaiton("last")},n.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},n.prototype.getPaginated=function(n,l,t,u,e){return m(this,void 0,void 0,function(){var s,a=this;return d(this,function(i){switch(i.label){case 0:return s=this,[4,this.smsService.getPaginatedStartAfter(n,l,t,u,e).subscribe(function(n){if(n.length>0&&(a.lastVisible=n[n.length-1].payload.doc.data(),a.firstVisible=n[0].payload.doc.data(),a.smsHistory=[],n.forEach(function(n){var l=n.payload.doc.data();l.id=n.payload.doc.id,a.smsHistory.push(l)}),console.log(a.smsHistory),"desc"===t)){var l=a.lastVisible;a.lastVisible=a.firstVisible,a.firstVisible=l,a.smsHistory.reverse()}})];case 1:return s.subscription=i.sent(),[2]}})})},n.prototype.paginaiton=function(n){switch(console.log(n),n){case"first":this.getPaginated(this.companyId,"date","asc",this.limit,null);break;case"previous":this.getPaginated(this.companyId,"date","desc",this.limit,this.firstVisible.date);break;case"next":this.getPaginated(this.companyId,"date","asc",this.limit,this.lastVisible.date);break;case"last":this.getPaginated(this.companyId,"date","desc",this.limit,new Date);break;default:console.log("I don't know who I am ")}},n.prototype.changeLimit=function(n){this.limit=parseInt(n),this.paginaiton("last")},n}(),g=u._2({encapsulation:0,styles:[[""]],data:{}});function y(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),u._25(-1,null,["\n  sms-history works!\n"])),(n()(),u._25(-1,null,["\n"]))],null,null)}var v=u._0("app-sms-history",b,function(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"app-sms-history",[],null,null,null,y,g)),u._3(1,245760,null,0,b,[f.a],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),k=function(){function n(){}return n.prototype.ngOnInit=function(){},n}(),S=u._2({encapsulation:0,styles:[[""]],data:{}});function w(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),u._25(-1,null,["\n  sms-settings works!\n"])),(n()(),u._25(-1,null,["\n"]))],null,null)}var I=u._0("app-sms-settings",k,function(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"app-sms-settings",[],null,null,null,w,S)),u._3(1,114688,null,0,k,[],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),M=t("89DD"),x=t("xOZh"),L=t("AP4T"),K=t("Jsyr");L.a.forkJoin=K.a;var O=t("roCq"),P=t("6Emk"),A=t("yNQF"),C=t("fmoM"),E=t("n68J"),N=this&&this.__awaiter||function(n,l,t,u){return new(t||(t=Promise))(function(e,s){function a(n){try{r(u.next(n))}catch(n){s(n)}}function i(n){try{r(u.throw(n))}catch(n){s(n)}}function r(n){n.done?e(n.value):new t(function(l){l(n.value)}).then(a,i)}r((u=u.apply(n,l||[])).next())})},D=this&&this.__generator||function(n,l){var t,u,e,s,a={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,u&&(e=u[2&s[0]?"return":s[0]?"throw":"next"])&&!(e=e.call(u,s[1])).done)return e;switch(u=0,e&&(s=[0,e.value]),s[0]){case 0:case 1:e=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,u=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(e=(e=a.trys).length>0&&e[e.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!e||s[1]>e[0]&&s[1]<e[3])){a.label=s[1];break}if(6===s[0]&&a.label<e[1]){a.label=e[1],e=s;break}if(e&&a.label<e[2]){a.label=e[2],a.ops.push(s);break}e[2]&&a.ops.pop(),a.trys.pop();continue}s=l.call(n,a)}catch(n){s=[6,n],u=0}finally{t=e=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},T=function(){function n(n,l,t,u,e){this.auth=n,this.companyService=l,this.customerService=t,this.smsService=u,this.smsApiService=e,this.customers=[],this.message="",this.errorMessage="",this.showSpiner=!1,this.companyId=localStorage.getItem("companyId")}return n.prototype.ngOnInit=function(){return N(this,void 0,void 0,function(){var n,l,t,u=this;return D(this,function(e){switch(e.label){case 0:return this.companyId?(n=this,[4,this.companyService.get(this.companyId).take(1).subscribe(function(n){return u.company=n},function(n){return console.log("Company info loading error",n)})]):[3,4];case 1:return n.subscription=e.sent(),l=this,[4,this.customerService.customers$.subscribe(function(n){u.customers=n.filter(function(n){return 1==n.active})})];case 2:return l.subscription=e.sent(),t=this,[4,this.auth.user$.subscribe(function(n){u.userId=n.uid})];case 3:t.subscription=e.sent(),e.label=4;case 4:return[2]}})})},n.prototype.balanceSMS=function(){var n=this,l=[],t=[],u=new Date,e=this.company.smsQuota;this.showSpiner=!0,e>this.customers.length?(this.customers.forEach(function(s){u.setSeconds(u.getSeconds()+1);var a="Dear customer, your current balance is "+s.balance+"taka, please pay your monthly bill. Thank you. Regards-"+n.company.companyName+n.company.telephone,i=new O.a("",null,null,new Date,n.companyId,n.userId,s.phone,a,"SEND SMS "+--e);t.push(n.smsService.create(i)),l.push(n.smsApiService.sendSMSUrl(s.phone,a,!1))}),this.company.smsQuota=e,t.push(this.companyService.update(this.companyId,this.company)),L.a.forkJoin(l).subscribe(function(l){n.showSpiner=!1,console.log(l)},function(n){console.log(n)}),L.a.forkJoin(t).subscribe(function(n){console.log(n)},function(n){console.log(n)})):this.errorMessage="Sorry! no sms quota, buy sms first"},n.prototype.clear=function(){this.showSpiner=!1,this.message="",this.errorMessage=""},n}(),Z=u._2({encapsulation:0,styles:[["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-left:8px}"]],data:{}});function V(n){return u._27(0,[(n()(),u._4(0,0,null,null,7,"div",[["class","alert alert-success text-center"],["role","alert"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(2,0,null,null,1,"strong",[],null,null,null,null,null)),(n()(),u._25(3,null,["",""])),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(5,0,null,null,1,"a",[["class","btn btn-warning btn-sm"]],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.clear()&&u),u},null,null)),(n()(),u._25(-1,null,["Clear"])),(n()(),u._25(-1,null,["\n      "]))],null,function(n,l){n(l,3,0,l.component.message)})}function H(n){return u._27(0,[(n()(),u._4(0,0,null,null,7,"div",[["class","alert alert-danger text-center"],["role","alert"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(2,0,null,null,1,"strong",[],null,null,null,null,null)),(n()(),u._25(3,null,["",""])),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(5,0,null,null,1,"a",[["class","btn btn-warning btn-sm"]],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.clear()&&u),u},null,null)),(n()(),u._25(-1,null,["Clear"])),(n()(),u._25(-1,null,["\n      "]))],null,function(n,l){n(l,3,0,l.component.errorMessage)})}function J(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"loading-spiner",[],null,null,null,M.b,M.a)),u._3(1,114688,null,0,x.a,[],null,null)],function(n,l){n(l,1,0)},null)}function j(n){return u._27(0,[(n()(),u._25(-1,null,["\n            "])),(n()(),u._4(1,0,null,null,1,"button",[["class","btn btn-success btn-sm"]],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==n.component.balanceSMS()&&u),u},null,null)),(n()(),u._25(-1,null,["Send"])),(n()(),u._25(-1,null,["\n          "]))],null,null)}function F(n){return u._27(0,[(n()(),u._4(0,0,null,null,45,"div",[["class","container"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n  "])),(n()(),u._4(2,0,null,null,10,"div",[["class","row p-0"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n    "])),(n()(),u._4(4,0,null,null,7,"div",[["class","col-12"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n      "])),(n()(),u.Z(16777216,null,null,1,null,V)),u._3(7,16384,null,0,a.k,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(n()(),u._25(-1,null,["\n      "])),(n()(),u.Z(16777216,null,null,1,null,H)),u._3(10,16384,null,0,a.k,[u.N,u.K],{ngIf:[0,"ngIf"]},null),(n()(),u._25(-1,null,["\n    "])),(n()(),u._25(-1,null,["\n  "])),(n()(),u._25(-1,null,["\n  "])),(n()(),u._4(14,0,null,null,30,"table",[["class","table table-bordered table-responsive-sm"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n    "])),(n()(),u._4(16,0,null,null,10,"thead",[["class","thead-dark"]],null,null,null,null,null)),(n()(),u._25(-1,null,["\n      "])),(n()(),u._4(18,0,null,null,7,"tr",[],null,null,null,null,null)),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(20,0,null,null,1,"th",[],null,null,null,null,null)),(n()(),u._25(-1,null,["Description"])),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(23,0,null,null,1,"th",[],null,null,null,null,null)),(n()(),u._25(-1,null,["Actions"])),(n()(),u._25(-1,null,["\n      "])),(n()(),u._25(-1,null,["\n    "])),(n()(),u._25(-1,null,["\n    "])),(n()(),u._4(28,0,null,null,15,"tbody",[],null,null,null,null,null)),(n()(),u._25(-1,null,["\n      "])),(n()(),u._4(30,0,null,null,12,"tr",[],null,null,null,null,null)),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(32,0,null,null,1,"td",[],null,null,null,null,null)),(n()(),u._25(-1,null,["Send balance sms to all active customer"])),(n()(),u._25(-1,null,["\n        "])),(n()(),u._4(35,0,null,null,6,"td",[],null,null,null,null,null)),(n()(),u._25(-1,null,["\n          "])),(n()(),u.Z(16777216,null,null,1,null,J)),u._3(38,16384,null,0,a.k,[u.N,u.K],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),u._25(-1,null,["\n          "])),(n()(),u.Z(0,[["showButton",2]],null,0,null,j)),(n()(),u._25(-1,null,["\n        "])),(n()(),u._25(-1,null,["\n      "])),(n()(),u._25(-1,null,["\n    "])),(n()(),u._25(-1,null,["\n  "])),(n()(),u._25(-1,null,["\n"]))],function(n,l){var t=l.component;n(l,7,0,(null==t.message?null:t.message.length)>0),n(l,10,0,(null==t.errorMessage?null:t.errorMessage.length)>0),n(l,38,0,t.showSpiner,u._16(l,40))},null)}var Q=u._0("app-send-sms",T,function(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"app-send-sms",[],null,null,null,F,Z)),u._3(1,114688,null,0,T,[P.a,A.a,C.a,f.a,E.a],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),U=function(){function n(){}return n.prototype.ngOnInit=function(){},n}(),q=u._2({encapsulation:0,styles:[[""]],data:{}});function G(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),u._25(-1,null,["\n  manual-sms works!\n"])),(n()(),u._25(-1,null,["\n"]))],null,null)}var R=u._0("app-manual-sms",U,function(n){return u._27(0,[(n()(),u._4(0,0,null,null,1,"app-manual-sms",[],null,null,null,G,q)),u._3(1,114688,null,0,U,[],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),Y=t("0nO6"),X=t("TMwh"),$=t("Z0p1"),z=t("2LMR"),B=t("xYmb"),W=t("Qhmg"),nn=t("eSJ/"),ln=t("0sFi"),tn=t("HVEd"),un=t("0JsY"),en=t("SFrA"),sn=t("uxIg"),an=t("E2XM"),rn=t("T2Au");t.d(l,"SmsModuleNgFactory",function(){return on});var on=u._1(e,[],function(n){return u._12([u._13(512,u.j,u.X,[[8,[p,v,I,Q,R]],[3,u.j],u.v]),u._13(4608,a.m,a.l,[u.s,[2,a.r]]),u._13(4608,Y.y,Y.y,[]),u._13(4608,Y.f,Y.f,[]),u._13(4608,X.c,X.c,[]),u._13(4608,X.g,X.b,[]),u._13(5120,X.i,X.j,[]),u._13(4608,X.h,X.h,[X.c,X.g,X.i]),u._13(4608,X.f,X.a,[]),u._13(5120,X.d,X.k,[X.h,X.f]),u._13(4608,P.a,P.a,[$.a,z.a,s.a,B.a]),u._13(4608,W.a,W.a,[P.a,s.k]),u._13(4608,nn.a,nn.a,[P.a]),u._13(4608,A.a,A.a,[$.a]),u._13(4608,ln.a,ln.a,[P.a]),u._13(4608,C.a,C.a,[$.a]),u._13(4608,tn.a,tn.a,[un.a]),u._13(4608,en.a,en.a,[$.a]),u._13(4608,sn.a,sn.a,[$.a]),u._13(4608,an.a,an.a,[$.a]),u._13(4608,E.a,E.a,[X.d]),u._13(4608,f.a,f.a,[$.a,E.a,A.a]),u._13(512,a.c,a.c,[]),u._13(512,Y.v,Y.v,[]),u._13(512,Y.g,Y.g,[]),u._13(512,Y.s,Y.s,[]),u._13(512,X.e,X.e,[]),u._13(512,rn.a,rn.a,[]),u._13(512,s.n,s.n,[[2,s.s],[2,s.k]]),u._13(512,e,e,[]),u._13(1024,s.i,function(){return[[{path:"",component:c,children:[{path:"sms-history",component:b},{path:"sms-settings",component:k},{path:"send-sms",component:T},{path:"manual-sms",component:U}]},{path:"**",redirectTo:"/"}]]},[])])})}});